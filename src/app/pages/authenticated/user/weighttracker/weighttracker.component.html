<div class="flex flex-col gap-8">
  @if(dataset) {
  <ml-linegraph [dataset]="dataset" [xAxisStep]="1" [yAxisStep]="0.5"
    [hasOffgridValue]="hasOffgridValue"></ml-linegraph>
  }

  <form #weightForm="ngForm" class="grid grid-cols-auto-1 gap-4 items-center">
    <label for="measurementDate">Measurement date</label>
    <input required class="input" validDate placeholder="DD-MM-YYYY" name="measurementDate"
      [(ngModel)]="measurementDate" />

    <label for="weight">Weight (kg)</label>
    <input required class="input" name="weight" type="number" [(ngModel)]="weight" step="0.1" />

    <label for="remark">Remark</label>
    <input class="input" name="remark" type="text" [(ngModel)]="remark" />

    <button class="btn btn--primary" (click)="saveNewWeight(weightForm)"
      [disabled]="weightForm.invalid">
      Save
    </button>
  </form>

  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Remark</th>
        <th>Weight</th>
      </tr>
    </thead>

    <tbody>
      @for (logWeight of trackedWeights; track logWeight) {
      <tr (click)="editWeight(logWeight)">
        @if (!logWeight.editMode) {
        <td>{{ logWeight.day | date: 'dd-MM-yyyy' }}</td>
        <td>{{ logWeight.remark }}</td>
        <td>
          {{ logWeight.weight | number: '1.1-1' }}
        </td>
        <div class="weight__hiddenbuttons"></div>
        }
        @if (logWeight.editMode) {
        <td>
          <div class="flex gap-2 items-center">
            <label for="date">Date</label>
            <input name="date" required validDate placeholder="DD-MM-YYYY"
              [(ngModel)]="logWeight.day" />
          </div>
        </td>

        <td>
          <div class="flex gap-2 items-center">
            <label for="weight">Weight</label>
            <input name="weight" type="number" [(ngModel)]="logWeight.weight"
              step="0.1" />
          </div>
        </td>

        <td>
          <div class="flex gap-2 items-center">
            <label for="comment">Comment</label>
            <input required class="fles-grow" name="comment" type="text" [(ngModel)]="logWeight.remark"
              [required]="false" />

            <button class="btn--icon" (click)="saveWeight(logWeight)">
              <em class="fas fa-check"></em>
            </button>

            <button class="btn--icon" (click)="deleteWeight(logWeight)">
              <em class="fas fa-trash"></em>
            </button>
          </div>
        </td>
        }
      </tr>
      }
    </tbody>

  </table>
</div>